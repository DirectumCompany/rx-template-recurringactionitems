<?xml version="1.0" encoding="utf-8"?>
<queries>
  <query key="CreateTableForTransferringOriginals">
    <mssql><![CDATA[if not exists
	(select
		* 
	from
		sysobjects
	where
		name = 'Sungero_Request_TransOriginals'
	and xtype='U')
create table [Sungero_Request_TransOriginals] (EDoc int unique, InitiatorTask int, SupervisorTask int)]]></mssql>
    <postgres><![CDATA[CREATE TABLE IF NOT EXISTS Sungero_Request_TransOriginals
  (
    EDOC integer,
    InitiatorTask integer,
    SupervisorTask integer,
    UNIQUE(EDOC)
  )]]></postgres>
  </query>
  <query key="SelectLastNotificationDate">
    <mssql><![CDATA[select
	Value
from
	Sungero_Docflow_Params
where
	[Key] = '{0}']]></mssql>
    <postgres><![CDATA[select
	Value
from
	Sungero_Docflow_Params
where
	Key = '{0}']]></postgres>
  </query>
  <query key="SelectDocumentWithSenderTask">
    <mssql><![CDATA[select
	EDoc
from
	Sungero_Request_TransOriginals
where
	[InitiatorTask] is not null
	and [SupervisorTask] is not null]]></mssql>
    <postgres><![CDATA[select
	EDoc
from
	Sungero_Request_TransOriginals
where
	[InitiatorTask] is not null
	and [SupervisorTask] is not null]]></postgres>
  </query>
  <query key="AddDocumentsToTable">
    <mssql><![CDATA[insert into Sungero_Request_TransOriginals ( EDoc ) values ({0})]]></mssql>
    <postgres><![CDATA[insert into Sungero_Request_TransOriginals ( EDoc ) values ({0})]]></postgres>
  </query>
  <query key="SelectTaskIDs">
    <mssql><![CDATA[select
	isnull(InitiatorTask , 0),  
	isnull(SupervisorTask , 0)
from
	Sungero_Request_TransOriginals
where
  Edoc = {0}]]></mssql>
    <postgres><![CDATA[select
	COALESCE(InitiatorTask , 0),  
	COALESCE(SupervisorTask , 0)
from
	Sungero_Request_TransOriginals
where
  Edoc = {0}]]></postgres>
  </query>
  <query key="AddTask">
    <mssql><![CDATA[if not exists
	(
		select
 			1
		from
			[dbo].[Sungero_Request_TransOriginals]
		where
			[EDoc] = {0}
	)
	insert
		[Sungero_Request_TransOriginals] ([EDoc], [{2}])  values ({0}, {1})
	else
		update
			Sungero_Request_TransOriginals
		set
			[{2}] = {1}
		where
			[EDoc] = {0}]]></mssql>
    <postgres><![CDATA[DO
$$
BEGIN
if not exists
	(select
		1
	from
		Sungero_Request_TransOriginals
	where
		EDoc = {0})
then		
	insert into
		Sungero_Request_TransOriginals (EDoc, {2})  values ({0}, {1});
else
	update
		Sungero_Request_TransOriginals
	set
		{2} = {1}
	where
		EDoc = {0};
end if;	
END$$]]></postgres>
  </query>
  <query key="UpdateLastNotificationDate">
    <mssql><![CDATA[if not exists
	(
		select
			1
		from
              	[dbo].[Sungero_Docflow_Params]
              where
              	[Key] = '{0}'
	)
	insert
		[Sungero_Docflow_Params] ([Key],Value) values ('{0}', '{1}')
	else
 		update
 			Sungero_Docflow_Params
		set
			Value = '{1}'
		where
			[Key] = '{0}']]></mssql>
    <postgres><![CDATA[DO
$$
BEGIN
if not exists
	(select
		1
	from
              Sungero_Docflow_Params
	where
		Key = '{0}'
	) 
then
	insert into
		Sungero_Docflow_Params (Key,Value) values ('{0}', '{1}');
else
 	update
 		Sungero_Docflow_Params
	set
			Value = '{1}'
		where
			Key = '{0}'; 
end if;	
END$$]]></postgres>
  </query>
</queries>