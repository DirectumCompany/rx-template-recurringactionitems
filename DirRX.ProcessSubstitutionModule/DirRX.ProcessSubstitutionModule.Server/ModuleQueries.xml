<?xml version="1.0" encoding="utf-8"?>
<queries>
  <query key="SelectDocflowParamsValue">
    <mssql><![CDATA[SELECT Value FROM Sungero_Docflow_Params WHERE ([Key] = '{0}')]]></mssql>
    <postgres><![CDATA[SELECT Value FROM Sungero_Docflow_Params WHERE (Key = '{0}')]]></postgres>
  </query>
  <query key="InsertOrUpdateDocflowParamsValue">
    <mssql><![CDATA[if not exists(select 1 from [dbo].[Sungero_Docflow_Params] where [Key] = '{0}')
  insert [Sungero_Docflow_Params] ([Key],Value) values ('{0}', '{1}')
else UPDATE Sungero_Docflow_Params SET Value = '{1}' WHERE ([Key] = '{0}')]]></mssql>
    <postgres><![CDATA[do $$
begin
  if not exists(select 1 from Sungero_Docflow_Params where Key = '{0}')
  then
    insert into Sungero_Docflow_Params (Key, Value) values ('{0}', '{1}');
  else
    UPDATE Sungero_Docflow_Params SET Value = '{1}' WHERE (Key = '{0}');
  end if;
end$$;]]></postgres>
  </query>
  <query key="UpdateRiskConfirmationFieldQuery">
    <mssql><![CDATA[update assignment
  set  assignment.[IsRiskConfirma_Solutio_DirRX] = stage.[IsRiskConfirma_Solutio_DirRX] 
from
  [dbo].[Sungero_WF_Assignment] assignment
  join [dbo].[Sungero_WF_Task] task on
    task.Id = assignment.Task
  join [dbo].[Sungero_Docflow_RuleStages] rs on
    rs.ApprovalRule = task.ApprovalRule_Docflow_Sungero
    and rs.Number = assignment.StageNumCheck_Docflow_Sungero
  join [dbo].[Sungero_Docflow_ApprovalStage] stage on
    stage.Id = rs.Stage
where 
  assignment.[IsRiskConfirma_Solutio_DirRX] is null
  and stage.[IsRiskConfirma_Solutio_DirRX] is not null]]></mssql>
  </query>
</queries>