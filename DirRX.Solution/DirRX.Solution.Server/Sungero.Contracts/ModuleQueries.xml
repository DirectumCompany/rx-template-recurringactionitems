<?xml version="1.0" encoding="utf-8"?>
<queries>
  <query key="SelectLastNotificationDate">
    <mssql><![CDATA[select
	Value
from
	Sungero_Docflow_Params
where
	[Key] = '{0}']]></mssql>
    <postgres><![CDATA[select
	Value
from
	Sungero_Docflow_Params
where
	Key = '{0}']]></postgres>
  </query>
  <query key="SelectDocumentWithSenderTask">
    <mssql><![CDATA[select
	EDoc
from
	Sungero_Contrac_ExpiringContractualDocs
where
	[Task] is not null]]></mssql>
    <postgres><![CDATA[select
	EDoc
from
	Sungero_Contrac_ExpiringContractualDocs
where
	Task is not null]]></postgres>
  </query>
  <query key="DeleteTasksWithoutDocuments">
    <mssql><![CDATA[delete from
	Sungero_Contrac_ExpiringContractualDocs
where
	[Task] is null]]></mssql>
    <postgres><![CDATA[delete from
	Sungero_Contrac_ExpiringContractualDocs
where
	Task is null]]></postgres>
  </query>
  <query key="DeleteTasksWithDocuments">
    <mssql><![CDATA[delete from
 	Sungero_Contrac_ExpiringContractualDocs
  where
  	[Task] is not null]]></mssql>
    <postgres><![CDATA[delete from
 	Sungero_Contrac_ExpiringContractualDocs
 where
 	Task is not null]]></postgres>
  </query>
  <query key="AddTask">
    <mssql><![CDATA[if not exists
	(
		select
 			1
		from
			[dbo].[Sungero_Contrac_ExpiringContractualDocs]
		where
			[EDoc] = {0}
	)
	insert
		[Sungero_Contrac_ExpiringContractualDocs] ([EDoc], [Task])  values ({0}, {1})
	else
		update
			Sungero_Contrac_ExpiringContractualDocs
		set
			[Task] = {1}
		where
			[EDoc] = {0}]]></mssql>
    <postgres><![CDATA[DO
$$
BEGIN
if not exists
	(select
		1
	from
		Sungero_Contrac_ExpiringContractualDocs
	where
		EDoc = {0})
then		
	insert into
		Sungero_Contrac_ExpiringContractualDocs (EDoc, Task)  values ({0}, {1});
else
	update
		Sungero_Contrac_ExpiringContractualDocs
	set
		Task = {1}
	where
		EDoc = {0};
end if;	
END$$]]></postgres>
  </query>
  <query key="CountNullTasks">
    <mssql><![CDATA[select
	count(*)
from
	Sungero_Contrac_ExpiringContractualDocs
where
	[Task] is null]]></mssql>
    <postgres><![CDATA[select
	count(*)
from
	Sungero_Contrac_ExpiringContractualDocs
where
	Task is null]]></postgres>
  </query>
  <query key="UpdateLastNotificationDate">
    <mssql><![CDATA[if not exists
	(
		select
			1
		from
              	[dbo].[Sungero_Docflow_Params]
              where
              	[Key] = '{0}'
	)
	insert
		[Sungero_Docflow_Params] ([Key],Value) values ('{0}', '{1}')
	else
 		update
 			Sungero_Docflow_Params
		set
			Value = '{1}'
		where
			[Key] = '{0}']]></mssql>
    <postgres><![CDATA[DO
$$
BEGIN
if not exists
	(select
		1
	from
              Sungero_Docflow_Params
	where
		Key = '{0}'
	) 
then
	insert into
		Sungero_Docflow_Params (Key,Value) values ('{0}', '{1}');
else
 	update
 		Sungero_Docflow_Params
	set
			Value = '{1}'
		where
			Key = '{0}'; 
end if;	
END$$]]></postgres>
  </query>
  <query key="CreateTableForExpiringContracts">
    <mssql><![CDATA[if not exists
	(select
		* 
	from
		sysobjects
	where
		name = 'Sungero_Contrac_ExpiringContractualDocs'
	and xtype='U')
create table [Sungero_Contrac_ExpiringContractualDocs] (EDoc int unique, Task int)]]></mssql>
    <postgres><![CDATA[CREATE TABLE IF NOT EXISTS Sungero_Contrac_ExpiringContractualDocs
  (
    EDOC integer,
    Task integer,
    UNIQUE(EDOC)
  )]]></postgres>
  </query>
  <query key="AddDocumentsToTable">
    <mssql><![CDATA[insert into Sungero_Contrac_ExpiringContractualDocs ( EDoc ) values ({0})]]></mssql>
    <postgres><![CDATA[insert into Sungero_Contrac_ExpiringContractualDocs ( EDoc ) values ({0})]]></postgres>
  </query>
</queries>